-- --------------------------------------------------------
-- ホスト:                          127.0.0.1
-- サーバーのバージョン:                   11.0.2-MariaDB - mariadb.org binary distribution
-- サーバー OS:                      Win64
-- HeidiSQL バージョン:               12.3.0.6589
-- --------------------------------------------------------

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET NAMES utf8 */;
/*!50503 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;


-- busiesecard_db のデータベース構造をダンプしています
CREATE DATABASE IF NOT EXISTS `busiesecard_db` /*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci */;
USE `busiesecard_db`;

--  テーブル busiesecard_db.account の構造をダンプしています
CREATE TABLE IF NOT EXISTS `account` (
  `AID` int(10) NOT NULL,
  `FN` varchar(50) NOT NULL,
  `Industry` varchar(100) NOT NULL,
  `Cname` varchar(20) NOT NULL,
  `Pass` varchar(100) NOT NULL,
  `Phonenum` varchar(100) NOT NULL,
  `gender` varchar(100) NOT NULL,
  `Prefecture` varchar(100) NOT NULL,
  `Address` varchar(100) NOT NULL,
  `Mailadd` varchar(100) NOT NULL,
  PRIMARY KEY (`AID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- テーブル busiesecard_db.account: ~17 rows (約) のデータをダンプしています
INSERT INTO `account` (`AID`, `FN`, `Industry`, `Cname`, `Pass`, `Phonenum`, `gender`, `Prefecture`, `Address`, `Mailadd`) VALUES
	(2023000001, '鈴木壱', 'ITエンジニア', 'jsp株式会社', 'pass', '09012342222', '男', '鹿児島県', '鹿児島県鹿児島市1-1-1', 'mail@mail.com'),
	(2023000002, 'ken matsudaira', '俳優', 'オスバーガー株式会社', 'pass', '080-1111-1112', '男', '北海道', '北海道札幌市a町1-1-2', 'mail2@mail.com'),
	(2023000003, 'yuji itadori', '営業職', '株式会社エンダッティー', 'pass', '080-1111-1113', '男', '青森県', '青森県ｓ市ｓ町1-ａ-2', 'mail3@mail.com'),
	(2023000004, 'satoru gojou', '教員', 'サブエイ株式会社', 'pass', '080-1111-1114', '男', '秋田県', '秋田県ｖ市ｖ町1-ａ-2', 'mail4@mail.com'),
	(2023000005, 'suguru getou', '公務員', 'BBB', 'pass', '080-1111-1115', '男', '岩手県', '岩手県ｓ市g町1-ａ-3', 'mail5@mail.com'),
	(2023000006, 'kento nanami', '事務職', 'CCC', 'pass', '080-1111-1116', '男', '宮城県', '宮城県宮城市ｒ町1-ｓ-1', 'mail6@mail.com'),
	(2023000007, 'yuta', 'カスタマーエンジニア', 'AGH', 'pass', '080-1111-1116', '男', '山形県', '山形県山形市ｒ町1-ｓ-1', 'mail7@mail.com'),
	(2023000008, 'nobara kugisaki', '警察官', 'NIN', 'pass', '080-1111-1117', '女', '福島県', '福島県福島市ｒ町1-ｒ-1', 'mail8@mail.com'),
	(2023000009, 'megumi fushiguro', 'セキュリティエンジニア', 'ASN', 'pass', '080-1111-1118', '男', '群馬県', '群馬県群馬市5町1-ｓ-2', 'mail9@mail.com'),
	(2023000010, 'maki zenin', '設計士', 'ZXC', 'pass', '080-1111-1121', '女', '栃木県', '栃木県栃木市ｒ町1-d-2', 'mail10@mail.com'),
	(2023000011, '人間とは()', 'ゲームクリエイター', 'sleep', 'pass', '09011112345', '男性', '東京都', '愛知県名古屋市熱田区', 'mail11@mail.com'),
	(2023000012, '金沢文雄', 'メーカー', 'Nine株式会社', 'pass', '09000009999', '男性', '北海道', '愛知県名古屋市熱田区', 'mail12@mail.com'),
	(2023000013, 'メルカリ', 'メーカー', 'タイミー', 'pass', '09011112222', '男性', '北海道', '愛知県名古屋市熱田区', 'mail13@mail.com'),
	(2023000014, 'スロット', 'youtuber', '5巣路', 'pass', '09011112222', '男性', '愛知県', '愛知県名古屋市熱田区', '777@mail.com'),
	(2023000015, '岐阜太郎', 'アイリスト', '岐阜ランド', 'pass', '09011112222', '男性', '岐阜県', '岐阜県岐阜市', 'gihu@mail.com'),
	(2023000016, '鹿児島県', 'ITエンジニア', 'ケイ', 'pass', '09011112222', '男性', '鹿児島県', '鹿児島県鹿児島市小野', 'kagoshima@mail.com'),
	(2023000017, '愛知県', 'ITエンジニア', '愛知IT', 'pass', '08011112222', '男性', '愛知県', '愛知県名古屋市熱田区', 'aaaa@mail.com');

--  テーブル busiesecard_db.chat の構造をダンプしています
CREATE TABLE IF NOT EXISTS `chat` (
  `ROOMID` int(11) NOT NULL AUTO_INCREMENT,
  `MESSAGEDATE` timestamp NOT NULL DEFAULT sysdate(),
  `RECEIVERID` int(11) DEFAULT NULL,
  `SENDERID` int(11) DEFAULT NULL,
  `SENTENCE` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`ROOMID`,`MESSAGEDATE`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- テーブル busiesecard_db.chat: ~12 rows (約) のデータをダンプしています
INSERT INTO `chat` (`ROOMID`, `MESSAGEDATE`, `RECEIVERID`, `SENDERID`, `SENTENCE`) VALUES
	(1, '2024-01-09 12:21:50', 2023000001, 2023000002, 'こんにちは'),
	(1, '2024-01-11 03:27:49', 2023000002, 2023000001, '999こんにちは'),
	(1, '2024-02-05 07:31:53', 2023000002, 2023000001, 'じゅんげむ'),
	(1, '2024-02-05 07:32:14', 2023000002, 2023000001, 'さあささ'),
	(1, '2024-02-05 07:32:17', 2023000002, 2023000001, 'a'),
	(1, '2024-02-05 07:32:55', 2023000002, 2023000001, 'a'),
	(1, '2024-02-05 23:16:57', 2023000002, 2023000001, 'うえーい'),
	(1, '2024-02-15 03:06:05', 2023000002, 2023000001, '5'),
	(1, '2024-02-15 03:06:28', 2023000002, 2023000002, '5'),
	(1, '2024-02-15 03:10:06', 2023000002, 2023000001, '5'),
	(1, '2024-02-15 03:11:05', 2023000001, 2023000002, '5'),
	(1, '2024-02-15 03:12:00', 2023000002, 2023000001, '5');

--  ビュー busiesecard_db.nop の構造をダンプしています
-- VIEW 依存エラーを克服するために、一時テーブルを作成
CREATE TABLE `nop` (
	`SENDER_ID` INT(10) NOT NULL,
	`RECIVER_ID` INT(10) NOT NULL,
	`FN` VARCHAR(50) NULL COLLATE 'utf8mb4_general_ci',
	`Cname` VARCHAR(20) NULL COLLATE 'utf8mb4_general_ci',
	`Phonenum` VARCHAR(100) NULL COLLATE 'utf8mb4_general_ci',
	`Address` VARCHAR(100) NULL COLLATE 'utf8mb4_general_ci',
	`Mailadd` VARCHAR(100) NULL COLLATE 'utf8mb4_general_ci',
	`FLAG` INT(1) NULL,
	`ROOM_ID` INT(100) NULL
) ENGINE=MyISAM;

--  テーブル busiesecard_db.schedule の構造をダンプしています
CREATE TABLE IF NOT EXISTS `schedule` (
  `id` int(11) DEFAULT NULL,
  `userid` int(11) DEFAULT NULL,
  `scheduledate` varchar(50) DEFAULT NULL,
  `starttime` varchar(50) DEFAULT NULL,
  `endtime` varchar(50) DEFAULT NULL,
  `schedule` varchar(50) DEFAULT NULL,
  `memo` varchar(50) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- テーブル busiesecard_db.schedule: ~16 rows (約) のデータをダンプしています
INSERT INTO `schedule` (`id`, `userid`, `scheduledate`, `starttime`, `endtime`, `schedule`, `memo`) VALUES
	(1024000001, 2023000001, '2023-12-12', '15:24', '19:24', '先輩とラウンドワン', '昼飯どこで食べよ'),
	(1024000002, 2023000001, '2023-12-21', '14:27', '12:27', 'ああああああ', 'ああああああ'),
	(1024000003, 2023000001, '2023-12-18', '14:40', '18:44', '生物の授業', '第8単元「クラゲの発生」'),
	(1024000004, 2023000001, '2023-12-26', '14:45', '19:45', '少し遅めのクリスマス', 'メリクリ'),
	(1024000005, 2023000002, '2023-12-27', '09:55', '14:49', '焼肉食べ放題', 'はらみ多めで'),
	(1024000006, 2023000002, '2023-11-29', '11:07', '13:07', 'ランチ', 'おいしい'),
	(1024000007, 2023000002, '2023-12-25', '18:36', '22:36', 'クリスマス!', 'チキンと寿司'),
	(1024000008, 2023000001, '2023-12-25', '18:14', '21:14', '在庫整理', '今日の在庫は2個のリンゴ'),
	(1024000009, 2023000001, '2023-12-27', '19:39', '18:39', 'sa', 'sa'),
	(1024000010, 2023000001, '2023-12-27', '18:47', '00:47', '寿司限界食い', 'マグロ多めで。'),
	(1024000011, 2023000001, '2023-12-27', '18:42', '17:42', 'sasa', 'dasdadasdsd'),
	(1024000012, 2023000034, '2023-12-21', '18:57', '20:57', '佐々木とゲーム', '私が佐々木だ'),
	(1024000013, 2023000034, '2023-12-13', '14:16', '18:14', '佐々木がゲーム機', 'いやいや私が佐々木だ'),
	(1024000014, 2023000034, '2023-12-05', '12:52', '12:52', '佐々木のゲーム', '私こそが佐々木'),
	(1024000015, 2023000034, '2024-01-01', '14:47', '16:47', 'もういくつねるとお正月', '正月楽しい'),
	(1024000016, 2023000004, '', '', '', '', '');

--  テーブル busiesecard_db.swap の構造をダンプしています
CREATE TABLE IF NOT EXISTS `swap` (
  `SENDER_ID` int(10) NOT NULL,
  `RECIVER_ID` int(10) NOT NULL,
  `FLAG` int(1) DEFAULT 0,
  `ROOM_ID` int(100) DEFAULT 0,
  PRIMARY KEY (`SENDER_ID`,`RECIVER_ID`) USING BTREE,
  KEY `RECIVER_ID` (`RECIVER_ID`) USING BTREE,
  CONSTRAINT `swap_ibfk_1` FOREIGN KEY (`SENDER_ID`) REFERENCES `account` (`AID`),
  CONSTRAINT `swap_ibfk_2` FOREIGN KEY (`RECIVER_ID`) REFERENCES `account` (`AID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- テーブル busiesecard_db.swap: ~156 rows (約) のデータをダンプしています
INSERT INTO `swap` (`SENDER_ID`, `RECIVER_ID`, `FLAG`, `ROOM_ID`) VALUES
	(2023000001, 2023000002, 5, 1),
	(2023000001, 2023000003, 0, 0),
	(2023000001, 2023000004, 0, 0),
	(2023000001, 2023000005, 0, 0),
	(2023000001, 2023000006, 0, 0),
	(2023000001, 2023000007, 0, 0),
	(2023000001, 2023000008, 0, 0),
	(2023000001, 2023000009, 0, 0),
	(2023000001, 2023000010, 0, 0),
	(2023000001, 2023000011, 0, 0),
	(2023000001, 2023000012, 0, 0),
	(2023000001, 2023000013, 0, 0),
	(2023000002, 2023000001, 5, 1),
	(2023000002, 2023000003, 0, 0),
	(2023000002, 2023000004, 0, 0),
	(2023000002, 2023000005, 0, 0),
	(2023000002, 2023000006, 0, 0),
	(2023000002, 2023000007, 0, 0),
	(2023000002, 2023000008, 0, 0),
	(2023000002, 2023000009, 0, 0),
	(2023000002, 2023000010, 0, 0),
	(2023000002, 2023000011, 0, 0),
	(2023000002, 2023000012, 0, 0),
	(2023000002, 2023000013, 0, 0),
	(2023000003, 2023000001, 0, 0),
	(2023000003, 2023000002, 0, 0),
	(2023000003, 2023000004, 0, 0),
	(2023000003, 2023000005, 0, 0),
	(2023000003, 2023000006, 0, 0),
	(2023000003, 2023000007, 0, 0),
	(2023000003, 2023000008, 0, 0),
	(2023000003, 2023000009, 0, 0),
	(2023000003, 2023000010, 0, 0),
	(2023000003, 2023000011, 0, 0),
	(2023000003, 2023000012, 0, 0),
	(2023000003, 2023000013, 0, 0),
	(2023000004, 2023000001, 0, 0),
	(2023000004, 2023000002, 0, 0),
	(2023000004, 2023000003, 0, 0),
	(2023000004, 2023000005, 0, 0),
	(2023000004, 2023000006, 0, 0),
	(2023000004, 2023000007, 0, 0),
	(2023000004, 2023000008, 0, 0),
	(2023000004, 2023000009, 0, 0),
	(2023000004, 2023000010, 0, 0),
	(2023000004, 2023000011, 0, 0),
	(2023000004, 2023000012, 0, 0),
	(2023000004, 2023000013, 0, 0),
	(2023000005, 2023000001, 0, 0),
	(2023000005, 2023000002, 0, 0),
	(2023000005, 2023000003, 0, 0),
	(2023000005, 2023000004, 0, 0),
	(2023000005, 2023000006, 0, 0),
	(2023000005, 2023000007, 0, 0),
	(2023000005, 2023000008, 0, 0),
	(2023000005, 2023000009, 0, 0),
	(2023000005, 2023000010, 0, 0),
	(2023000005, 2023000011, 0, 0),
	(2023000005, 2023000012, 0, 0),
	(2023000005, 2023000013, 0, 0),
	(2023000006, 2023000001, 0, 0),
	(2023000006, 2023000002, 0, 0),
	(2023000006, 2023000003, 0, 0),
	(2023000006, 2023000004, 0, 0),
	(2023000006, 2023000005, 0, 0),
	(2023000006, 2023000007, 0, 0),
	(2023000006, 2023000008, 0, 0),
	(2023000006, 2023000009, 0, 0),
	(2023000006, 2023000010, 0, 0),
	(2023000006, 2023000011, 0, 0),
	(2023000006, 2023000012, 0, 0),
	(2023000006, 2023000013, 0, 0),
	(2023000007, 2023000001, 0, 0),
	(2023000007, 2023000002, 0, 0),
	(2023000007, 2023000003, 0, 0),
	(2023000007, 2023000004, 0, 0),
	(2023000007, 2023000005, 0, 0),
	(2023000007, 2023000006, 0, 0),
	(2023000007, 2023000008, 0, 0),
	(2023000007, 2023000009, 0, 0),
	(2023000007, 2023000010, 0, 0),
	(2023000007, 2023000011, 0, 0),
	(2023000007, 2023000012, 0, 0),
	(2023000007, 2023000013, 0, 0),
	(2023000008, 2023000001, 0, 0),
	(2023000008, 2023000002, 0, 0),
	(2023000008, 2023000003, 0, 0),
	(2023000008, 2023000004, 0, 0),
	(2023000008, 2023000005, 0, 0),
	(2023000008, 2023000006, 0, 0),
	(2023000008, 2023000007, 0, 0),
	(2023000008, 2023000009, 0, 0),
	(2023000008, 2023000010, 0, 0),
	(2023000008, 2023000011, 0, 0),
	(2023000008, 2023000012, 0, 0),
	(2023000008, 2023000013, 0, 0),
	(2023000009, 2023000001, 0, 0),
	(2023000009, 2023000002, 0, 0),
	(2023000009, 2023000003, 0, 0),
	(2023000009, 2023000004, 0, 0),
	(2023000009, 2023000005, 0, 0),
	(2023000009, 2023000006, 0, 0),
	(2023000009, 2023000007, 0, 0),
	(2023000009, 2023000008, 0, 0),
	(2023000009, 2023000010, 0, 0),
	(2023000009, 2023000011, 0, 0),
	(2023000009, 2023000012, 0, 0),
	(2023000009, 2023000013, 0, 0),
	(2023000010, 2023000001, 0, 0),
	(2023000010, 2023000002, 0, 0),
	(2023000010, 2023000003, 0, 0),
	(2023000010, 2023000004, 0, 0),
	(2023000010, 2023000005, 0, 0),
	(2023000010, 2023000006, 0, 0),
	(2023000010, 2023000007, 0, 0),
	(2023000010, 2023000008, 0, 0),
	(2023000010, 2023000009, 0, 0),
	(2023000010, 2023000011, 0, 0),
	(2023000010, 2023000012, 0, 0),
	(2023000010, 2023000013, 0, 0),
	(2023000011, 2023000001, 0, 0),
	(2023000011, 2023000002, 0, 0),
	(2023000011, 2023000003, 0, 0),
	(2023000011, 2023000004, 0, 0),
	(2023000011, 2023000005, 0, 0),
	(2023000011, 2023000006, 0, 0),
	(2023000011, 2023000007, 0, 0),
	(2023000011, 2023000008, 0, 0),
	(2023000011, 2023000009, 0, 0),
	(2023000011, 2023000010, 0, 0),
	(2023000011, 2023000012, 0, 0),
	(2023000011, 2023000013, 0, 0),
	(2023000012, 2023000001, 0, 0),
	(2023000012, 2023000002, 0, 0),
	(2023000012, 2023000003, 0, 0),
	(2023000012, 2023000004, 0, 0),
	(2023000012, 2023000005, 0, 0),
	(2023000012, 2023000006, 0, 0),
	(2023000012, 2023000007, 0, 0),
	(2023000012, 2023000008, 0, 0),
	(2023000012, 2023000009, 0, 0),
	(2023000012, 2023000010, 0, 0),
	(2023000012, 2023000011, 0, 0),
	(2023000012, 2023000013, 0, 0),
	(2023000013, 2023000001, 0, 0),
	(2023000013, 2023000002, 0, 0),
	(2023000013, 2023000003, 0, 0),
	(2023000013, 2023000004, 0, 0),
	(2023000013, 2023000005, 0, 0),
	(2023000013, 2023000006, 0, 0),
	(2023000013, 2023000007, 0, 0),
	(2023000013, 2023000008, 0, 0),
	(2023000013, 2023000009, 0, 0),
	(2023000013, 2023000010, 0, 0),
	(2023000013, 2023000011, 0, 0),
	(2023000013, 2023000012, 0, 0);

--  ビュー busiesecard_db.nop の構造をダンプしています
-- 一時テーブルを削除して、最終的な VIEW 構造を作成
DROP TABLE IF EXISTS `nop`;
CREATE ALGORITHM=UNDEFINED SQL SECURITY DEFINER VIEW `nop` AS SELECT swap.SENDER_ID,swap.RECIVER_ID,account.FN,account.Cname,account.Phonenum,account.Address,account.Mailadd,swap.FLAG,swap.ROOM_ID
FROM swap LEFT OUTER JOIN account ON account.AID = swap.RECIVER_ID ;

/*!40103 SET TIME_ZONE=IFNULL(@OLD_TIME_ZONE, 'system') */;
/*!40101 SET SQL_MODE=IFNULL(@OLD_SQL_MODE, '') */;
/*!40014 SET FOREIGN_KEY_CHECKS=IFNULL(@OLD_FOREIGN_KEY_CHECKS, 1) */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40111 SET SQL_NOTES=IFNULL(@OLD_SQL_NOTES, 1) */;
